<UserControl x:Class="CustomGridControl.TelerikCustomDataGrid"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:CustomGridControl"
             xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="1200"
             UseLayoutRounding="True"
             SnapsToDevicePixels="True">
    <UserControl.Resources>
        <local:CellStateToBackgroundConverter x:Key="CellStateToBackgroundConverter"/>
        <local:CellStateToVisibilityConverter x:Key="CellStateToVisibilityConverter"/>
        <local:CellTypeToVisibilityConverter x:Key="CellTypeToVisibilityConverter"/>
        
        <!-- Name Column Styles -->
        <Style x:Key="NameOldValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="TextDecorations" Value="Strikethrough"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Name.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="None"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="NameNewValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="TextDecorations" Value="None"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Name.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="Strikethrough"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Email Column Styles -->
        <Style x:Key="EmailOldValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="TextDecorations" Value="Strikethrough"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Email.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="None"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="EmailNewValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="TextDecorations" Value="None"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Email.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="Strikethrough"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Address Column Styles -->
        <Style x:Key="AddressOldValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="TextDecorations" Value="Strikethrough"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Address.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="None"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="AddressNewValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="TextDecorations" Value="None"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Address.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="Strikethrough"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Phone Column Styles -->
        <Style x:Key="PhoneOldValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="TextDecorations" Value="Strikethrough"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Phone.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="None"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="PhoneNewValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="TextDecorations" Value="None"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Phone.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="Strikethrough"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Position Column Styles -->
        <Style x:Key="PositionOldValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="TextDecorations" Value="Strikethrough"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Position.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="None"/>
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="PositionNewValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="TextDecorations" Value="None"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="Auto"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Position.CellState}" Value="Rejected">
                    <Setter Property="TextDecorations" Value="Strikethrough"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="RoundedButton" TargetType="Button">
            <Setter Property="Width" Value="18"/>
            <Setter Property="Height" Value="18"/>
            <Setter Property="Margin" Value="2,0,0,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="9"
                                BorderThickness="0"
                                UseLayoutRounding="True"
                                SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center" 
                                              VerticalAlignment="Center"
                                              UseLayoutRounding="True"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Editable Cell Template -->
        <DataTemplate x:Key="EditableCellTemplate">
            <Border BorderBrush="LightGray" BorderThickness="1" Padding="5">
                <Border.Background>
                    <MultiBinding Converter="{StaticResource CellStateToBackgroundConverter}">
                        <Binding Path="CellState"/>
                        <Binding Path="CellType"/>
                    </MultiBinding>
                </Border.Background>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" 
                               Text="{Binding OldValue}" 
                               Style="{StaticResource OldValueStyle}"
                               Margin="2"/>
                    
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0"
                                   Text="{Binding NewValue}" 
                                   Style="{StaticResource NewValueStyle}"
                                   Margin="2"
                                   VerticalAlignment="Center"/>

                        <StackPanel Grid.Column="1" 
                                    Orientation="Horizontal" 
                                    VerticalAlignment="Center"
                                    Margin="5,0,0,0">
                            <Button Name="AcceptButton" Content="✓" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#4CAF50" 
                                    Foreground="White"
                                    Click="AcceptButton_Click"
                                    Tag="{Binding}"
                                    Visibility="{Binding CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowTick}"/>
                            <Button Name="RejectButton" Content="✗" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#F44336" 
                                    Foreground="White"
                                    Click="RejectButton_Click"
                                    Tag="{Binding}"
                                    Visibility="{Binding CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowX}"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
        </DataTemplate>
        
        <!-- ReadOnly Cell Template -->
        <DataTemplate x:Key="ReadOnlyCellTemplate">
            <Border Background="White" BorderBrush="LightGray" BorderThickness="1" Padding="5">
                <TextBlock Text="{Binding NewValue}" 
                           Foreground="Black"
                           Margin="2"
                           VerticalAlignment="Center"/>
            </Border>
        </DataTemplate>
        
        <!-- Name Column Template -->
        <DataTemplate x:Key="NameCellTemplate">
            <Border BorderBrush="LightGray" BorderThickness="1" Padding="5">
                <Border.Background>
                    <MultiBinding Converter="{StaticResource CellStateToBackgroundConverter}">
                        <Binding Path="Name.CellState"/>
                        <Binding Path="Name.CellType"/>
                    </MultiBinding>
                </Border.Background>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" 
                               Text="{Binding Name.OldValue}" 
                               Style="{StaticResource NameOldValueStyle}"
                               Margin="2"
                               Visibility="{Binding Name.CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=Editable}"/>
                    
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0"
                                   Text="{Binding Name.NewValue}" 
                                   Style="{StaticResource NameNewValueStyle}"
                                   Margin="2"
                                   VerticalAlignment="Center"/>

                        <StackPanel Grid.Column="1" 
                                    Orientation="Horizontal" 
                                    VerticalAlignment="Center"
                                    Margin="5,0,0,0"
                                    Visibility="{Binding Name.CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=Editable}">
                            <Button Name="AcceptButton" Content="✓" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#4CAF50" 
                                    Foreground="White"
                                    Click="AcceptButton_Click"
                                    Tag="{Binding Name}"
                                    Visibility="{Binding Name.CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowTick}"/>
                            <Button Name="RejectButton" Content="✗" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#F44336" 
                                    Foreground="White"
                                    Click="RejectButton_Click"
                                    Tag="{Binding Name}"
                                    Visibility="{Binding Name.CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowX}"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
        </DataTemplate>

        <!-- Email Column Template -->
        <DataTemplate x:Key="EmailCellTemplate">
            <Border BorderBrush="LightGray" BorderThickness="1" Padding="5">
                <Border.Background>
                    <MultiBinding Converter="{StaticResource CellStateToBackgroundConverter}">
                        <Binding Path="Email.CellState"/>
                        <Binding Path="Email.CellType"/>
                    </MultiBinding>
                </Border.Background>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" 
                               Text="{Binding Email.OldValue}" 
                               Style="{StaticResource EmailOldValueStyle}"
                               Margin="2"
                               Visibility="{Binding Email.CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=Editable}"/>
                    
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0"
                                   Text="{Binding Email.NewValue}" 
                                   Style="{StaticResource EmailNewValueStyle}"
                                   Margin="2"
                                   VerticalAlignment="Center"/>

                        <StackPanel Grid.Column="1" 
                                    Orientation="Horizontal" 
                                    VerticalAlignment="Center"
                                    Margin="5,0,0,0"
                                    Visibility="{Binding Email.CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=Editable}">
                            <Button Name="AcceptButton" Content="✓" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#4CAF50" 
                                    Foreground="White"
                                    Click="AcceptButton_Click"
                                    Tag="{Binding Email}"
                                    Visibility="{Binding Email.CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowTick}"/>
                            <Button Name="RejectButton" Content="✗" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#F44336" 
                                    Foreground="White"
                                    Click="RejectButton_Click"
                                    Tag="{Binding Email}"
                                    Visibility="{Binding Email.CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowX}"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
        </DataTemplate>

        <!-- Address Column Template -->
        <DataTemplate x:Key="AddressCellTemplate">
            <Border BorderBrush="LightGray" BorderThickness="1" Padding="5">
                <Border.Background>
                    <MultiBinding Converter="{StaticResource CellStateToBackgroundConverter}">
                        <Binding Path="Address.CellState"/>
                        <Binding Path="Address.CellType"/>
                    </MultiBinding>
                </Border.Background>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" 
                               Text="{Binding Address.OldValue}" 
                               Style="{StaticResource AddressOldValueStyle}"
                               Margin="2"
                               Visibility="{Binding Address.CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=Editable}"/>
                    
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0"
                                   Text="{Binding Address.NewValue}" 
                                   Style="{StaticResource AddressNewValueStyle}"
                                   Margin="2"
                                   VerticalAlignment="Center"/>

                        <StackPanel Grid.Column="1" 
                                    Orientation="Horizontal" 
                                    VerticalAlignment="Center"
                                    Margin="5,0,0,0"
                                    Visibility="{Binding Address.CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=Editable}">
                            <Button Name="AcceptButton" Content="✓" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#4CAF50" 
                                    Foreground="White"
                                    Click="AcceptButton_Click"
                                    Tag="{Binding Address}"
                                    Visibility="{Binding Address.CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowTick}"/>
                            <Button Name="RejectButton" Content="✗" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#F44336" 
                                    Foreground="White"
                                    Click="RejectButton_Click"
                                    Tag="{Binding Address}"
                                    Visibility="{Binding Address.CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowX}"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
        </DataTemplate>

        <!-- Phone Column Template -->
        <DataTemplate x:Key="PhoneCellTemplate">
            <Border BorderBrush="LightGray" BorderThickness="1" Padding="5">
                <Border.Background>
                    <MultiBinding Converter="{StaticResource CellStateToBackgroundConverter}">
                        <Binding Path="Phone.CellState"/>
                        <Binding Path="Phone.CellType"/>
                    </MultiBinding>
                </Border.Background>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" 
                               Text="{Binding Phone.OldValue}" 
                               Style="{StaticResource PhoneOldValueStyle}"
                               Margin="2"
                               Visibility="{Binding Phone.CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=Editable}"/>
                    
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0"
                                   Text="{Binding Phone.NewValue}" 
                                   Style="{StaticResource PhoneNewValueStyle}"
                                   Margin="2"
                                   VerticalAlignment="Center"/>

                        <StackPanel Grid.Column="1" 
                                    Orientation="Horizontal" 
                                    VerticalAlignment="Center"
                                    Margin="5,0,0,0"
                                    Visibility="{Binding Phone.CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=Editable}">
                            <Button Name="AcceptButton" Content="✓" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#4CAF50" 
                                    Foreground="White"
                                    Click="AcceptButton_Click"
                                    Tag="{Binding Phone}"
                                    Visibility="{Binding Phone.CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowTick}"/>
                            <Button Name="RejectButton" Content="✗" 
                                    Style="{StaticResource RoundedButton}"
                                    Background="#F44336" 
                                    Foreground="White"
                                    Click="RejectButton_Click"
                                    Tag="{Binding Phone}"
                                    Visibility="{Binding Phone.CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowX}"/>
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
        </DataTemplate>

        <!-- Dynamic Cell Template -->
        <DataTemplate x:Key="DynamicCellTemplate">
            <Border BorderBrush="LightGray" BorderThickness="1" Padding="3">
                <Border.Background>
                    <MultiBinding Converter="{StaticResource CellStateToBackgroundConverter}">
                        <Binding Path="CellState"/>
                        <Binding Path="CellType"/>
                    </MultiBinding>
                </Border.Background>
                
                <!-- Show different layouts for Editable vs ReadOnly -->
                <Grid>
                    <!-- Editable Cell Layout -->
                    <Grid Visibility="{Binding CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=Editable}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Old Value (strikethrough) -->
                        <TextBlock Grid.Row="0" 
                                   Text="{Binding OldValue}" 
                                   FontSize="10"
                                   Margin="1">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Foreground" Value="Gray"/>
                                    <Setter Property="TextDecorations" Value="Strikethrough"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding CellState}" Value="Rejected">
                                            <Setter Property="TextDecorations" Value="None"/>
                                            <Setter Property="Foreground" Value="Black"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                        
                        <!-- New Value + Buttons Row -->
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- New Value -->
                            <TextBlock Grid.Column="0"
                                       Text="{Binding NewValue}" 
                                       FontSize="12"
                                       VerticalAlignment="Center"
                                       Margin="1">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="Black"/>
                                        <Setter Property="TextDecorations" Value="None"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding CellState}" Value="Rejected">
                                                <Setter Property="TextDecorations" Value="Strikethrough"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                            
                            <!-- Accept/Reject Buttons -->
                            <StackPanel Grid.Column="1" 
                                        Orientation="Horizontal"
                                        VerticalAlignment="Center">
                                <Button Content="✓" 
                                        Width="16" Height="16"
                                        FontSize="10"
                                        Background="#4CAF50" 
                                        Foreground="White"
                                        BorderThickness="0"
                                        Margin="1,0,0,0"
                                        Click="AcceptButton_Click"
                                        Tag="{Binding}"
                                        ToolTip="Accept"
                                        Visibility="{Binding CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowTick}"/>
                                <Button Content="✗" 
                                        Width="16" Height="16"
                                        FontSize="10"
                                        Background="#F44336" 
                                        Foreground="White"
                                        BorderThickness="0"
                                        Margin="1,0,0,0"
                                        Click="RejectButton_Click"
                                        Tag="{Binding}"
                                        ToolTip="Reject"
                                        Visibility="{Binding CellState, Converter={StaticResource CellStateToVisibilityConverter}, ConverterParameter=ShowX}"/>
                            </StackPanel>
                        </Grid>
                    </Grid>
                    
                    <!-- ReadOnly Cell Layout -->
                    <TextBlock Visibility="{Binding CellType, Converter={StaticResource CellTypeToVisibilityConverter}, ConverterParameter=ReadOnly}"
                               Text="{Binding NewValue}" 
                               FontSize="12"
                               Foreground="Black"
                               VerticalAlignment="Center"
                               Margin="2"/>
                </Grid>
            </Border>
        </DataTemplate>
    </UserControl.Resources>

    <telerik:RadGridView Name="MainRadGridView" 
                         ItemsSource="{Binding DynamicGridData}"
                         AutoGenerateColumns="False"
                         CanUserDeleteRows="False"
                         CanUserInsertRows="False"
                         ShowGroupPanel="False"
                         GridLinesVisibility="Both"
                         IsFilteringAllowed="False"
                         EnableRowVirtualization="True"
                         EnableColumnVirtualization="True"
                         ScrollMode="Deferred"
                         VirtualizingPanel.VirtualizationMode="Recycling"
                         VirtualizingPanel.ScrollUnit="Pixel"
                         ScrollViewer.CanContentScroll="True">
        
        <!-- Columns will be generated dynamically in code-behind -->
    </telerik:RadGridView>
</UserControl>